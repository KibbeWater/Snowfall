#include "pch.h"

INL bool Hook::Init()
{
	if (MH_Initialize() != MH_OK)
		return false;

	// TODO:
	// Add reach for punching (Somewhat done???)
	// Fix up all static classes (pre-game freeze disabler not working)
	// Fix another pattern for StealHat, causes some kind of overflow due to long pattern

	// Do hooks
	{
		DO_HOOK(MEM::PatternScan("GameAssembly.dll", "40 53 48 83 EC ? 80 3D ? ? ? ? ? 48 8B D9 75 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? C6 05 ? ? ? ? ? 80 7B ? ? 74 ? F3 0F 10 15 ? ? ? ? 45 33 C9 C6 43 ? ? 48 8B CB 48 8B 15 ? ? ? ? E8 ? ? ? ? 48 8B 05 ? ? ? ? 48 8B 88 ? ? ? ? 48 8B 09 48 85 C9 74 ? 33 D2 E8 ? ? ? ? 48 8B 4B ? 48 85 C9 74 ? F3 0F 10 15 ? ? ? ? 45 33 C9 0F 57 C9"), 
			PunchPlayers, Punch);
		DO_HOOK(MEM::PatternScan("GameAssembly.dll", "48 89 5C 24 ? 48 89 6C 24 ? 48 89 74 24 ? 57 48 83 EC ? 80 3D ? ? ? ? ? 49 8B D8 48 8B EA 48 8B F1 75 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? C6 05 ? ? ? ? ? 48 8B 0D ? ? ? ? E8"), 
			CameraShake, Shake);
		DO_HOOK(MEM::PatternScan("GameAssembly.dll", "48 89 5C 24 ? 48 89 74 24 ? 57 48 83 EC ? 80 3D ? ? ? ? ? 48 8B F2 48 8B D9 75 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? C6 05 ? ? ? ? ? 48 8B 7B"),
			PlayerMovement, PushPlayer);
		DO_HOOK(MEM::PatternScan("GameAssembly.dll", "48 89 5C 24 ? 55 48 8D 6C 24 ? 48 81 EC ? ? ? ? 80 3D ? ? ? ? ? 48 8B D9 75 37"),
			PlayerMovement, Jump);
		DO_HOOK(MEM::PatternScan("GameAssembly.dll", "40 53 48 83 EC 50 80 79 40 00"),
			PlayerMovement, Update);
		DO_HOOK(MEM::PatternScan("GameAssembly.dll", "40 53 48 83 EC ? 80 79 ? ? 48 8B D9 75 ? 0F 29 7C 24 ? 33 D2 E8 ? ? ? ? F3 0F 10 05 ? ? ? ? F3 0F 10 BB ? ? ? ? 0F 2F C7 76 ? 0F 29 74 24 ? 33 C9 F3 0F 10 B3 ? ? ? ? E8 ? ? ? ? F3 0F 59 C6 0F 28 74 24 ? F3 0F 58 C7 F3 0F 11 83 ? ? ? ? 48 8B 53 ? 0F 28 7C 24 ? 48 85 D2 74 ? 45 33 C0 48 8D 4C 24 ? E8 ? ? ? ? F3 0F 10 40 ? F3 0F 11 83 ? ? ? ? 48 83 C4 ? 5B C3 E8 ? ? ? ? CC CC CC CC 48 83 EC"),
			PlayerMovement, Movement);
		DO_HOOK(MEM::PatternScan("GameAssembly.dll", "40 53 48 83 EC ? 80 3D ? ? ? ? ? 48 8B D9 75 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? C6 05 ? ? ? ? ? 80 7B ? ? 0F 84 ? ? ? ? 48 8B 05 ? ? ? ? 48 8B 88 ? ? ? ? 80 39 ? 75"),
			PlayerInput, Update);
		DO_HOOK(MEM::PatternScan("GameAssembly.dll", "48 89 5C 24 ? 57 48 81 EC ? ? ? ? 33 D2 48 8B D9"),
			OnlinePlayerMovement, Update);
		DO_HOOK(MEM::PatternScan("GameAssembly.dll", "40 53 48 83 EC 20 48 8B D9 48 85 C9 74 71"),
			AntiCheat, CheatingDetected);
		DO_HOOK(MEM::PatternScan("GameAssembly.dll", "48 89 5C 24 ? 56 48 83 EC ? 80 3D ? ? ? ? ? 0F B6 F2 48 8B D9 75 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? C6 05 ? ? ? ? ? 80 7B ? ? 48 89 7C 24 ? 74 ? 48 8B 05 ? ? ? ? 48 8B 88 ? ? ? ? 48 8B 09 48 85 C9 0F 84 ? ? ? ? 45 33 C9"),
			GamemodeLights, ToggleLights);
		DO_HOOK(MEM::PatternScan("GameAssembly.dll", "40 53 48 83 EC ? 80 3D ? ? ? ? ? 48 8B D9 0F 29 74 24 ? 0F 28 F1 75 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? C6 05 ? ? ? ? ? 48 8B 05"),
			GamemodeRedLight, RedLight);
		DO_HOOK(MEM::PatternScan("GameAssembly.dll", "40 53 48 83 EC ? 80 3D ? ? ? ? ? 48 8B D9 0F 29 74 24 ? 0F 28 F1 75 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? C6 05 ? ? ? ? ? 48 8B 05 ? ? ? ? 48 8B 90 ? ? ? ? 48 8B 0A 48 85 C9 0F 84 ? ? ? ? 45 33 C0 0F 28 CE E8 ? ? ? ? F3 0F 10 43 ? F3 0F 10 4B ? 0F 2F C1 C6 43 ? ? 76 ? F3 0F 5C 43 ? F3 0F 10 53 ? 45 33 C9 F3 0F 11 43 ? E8 ? ? ? ? F3 0F 11 43 ? 48 8B 05 ? ? ? ? F6 80 ? ? ? ? ? 74 ? 83 B8 ? ? ? ? ? 75 ? 48 8B C8 E8 ? ? ? ? 48 8B 05 ? ? ? ? 48 8B 80 ? ? ? ? 48 8B 08 48 85 C9 74 ? 33 D2 E8 ? ? ? ? 84 C0 74 ? 33 D2 48 8B CB E8 ? ? ? ? 0F 28 74 24 ? 48 83 C4 ? 5B C3 E8 ? ? ? ? CC CC CC CC CC CC CC 48 83 EC"),
			GamemodeRedLight, GreenLight);
		DO_HOOK(MEM::PatternScan("GameAssembly.dll", "48 89 5C 24 ? 48 89 74 24 ? 57 48 83 EC 60 80 3D ? ? ? ? ? 49 8B F0 48 8B DA 48 8B F9 75 73"),
			GamemodeBombTag, TagPlayer);
		/*DO_HOOK(MEM::PatternScan("GameAssembly.dll", "48 89 5C 24 ? 48 89 74 24 ? 57 48 83 EC ? 80 3D ? ? ? ? ? 49 8B F0 48 8B FA 48 8B D9 75 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? C6 05 ? ? ? ? ? 0F 29 7C 24 ? 48 85 FF 74 ? 48 8B 05 ? ? ? ? 48 8B 88 ? ? ? ? 48 8B 01 48 85 C0 0F 84 ? ? ? ? 48 8B 48 ? 48 85 C9 0F 84 ? ? ? ? 4C 8B 05 ? ? ? ? 48 8B D7 E8 ? ? ? ? 84 C0 74 ? 45 33 C9 4C 8B C7 B2 ? 48 8B CB E8 ? ? ? ? 45 33 C9 4C 8B C6 33 D2 48 8B CB E8 ? ? ? ? 48 8B 4B ? 48 85 C9 0F 84 ? ? ? ? 4C 8B 05 ? ? ? ? 48 8B D6 E8 ? ? ? ? 84 C0 74 ? 48 8B 4B ? 48 85 C9 0F 84 ? ? ? ? 4C 8B 05 ? ? ? ? 48 8B D6 E8 ? ? ? ? 48 8B 4B ? 48 85 C9 0F 84 ? ? ? ? 4C 8B 05 ? ? ? ? 48 8B D7 E8 ? ? ? ? 48 8B 0D ? ? ? ? F6 81 ? ? ? ? ? 74 ? 83 B9 ? ? ? ? ? 75 ? E8 ? ? ? ? 48 8B 0D ? ? ? ? 48 8B 81 ? ? ? ? 48 8B 10 48 85 D2 0F 84 ? ? ? ? 48 3B 7A ? 0F 84 ? ? ? ? F6 81 ? ? ? ? ? 74 ? 83 B9 ? ? ? ? ? 75 ? E8 ? ? ? ? 48 8B 0D ? ? ? ? 48 8B 81 ? ? ? ? 48 8B 08 48 85 C9 0F 84 ? ? ? ? 48 3B 71 ? 0F 85 ? ? ? ? 80 3D ? ? ? ? ? 75 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? C6 05 ? ? ? ? ? 48 8B 05 ? ? ? ? 48 8B 88 ? ? ? ? 48 8B 01 48 85 C0 0F 84 ? ? ? ? 48 8B 48 ? 48 85 C9 0F 84 ? ? ? ? 33 D2 EB ? 80 3D ? ? ? ? ? 75 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? C6 05 ? ? ? ? ? 48 8B 05 ? ? ? ? 48 8B 88 ? ? ? ? 48 8B 01 48 85 C0 0F 84 ? ? ? ? 48 8B 48 ? 48 85 C9 0F 84 ? ? ? ? B2 ? 45 33 C0 E8 ? ? ? ? 48 8B 05 ? ? ? ? 48 8B 88 ? ? ? ? 48 8B 01 48 85 C0 0F 84 ? ? ? ? 48 8B 48 ? 48 85 C9 0F 84 ? ? ? ? 4C 8B 05 ? ? ? ? 48 8B D6 E8 ? ? ? ? 84 C0 0F 84 ? ? ? ? 48 8B 05 ? ? ? ? 48 8B 88 ? ? ? ? 48 8B 01 48 85 C0 0F 84 ? ? ? ? 48 8B 48 ? 48 85 C9 0F 84 ? ? ? ? 4C 8B 05 ? ? ? ? 48 8B D6 E8 ? ? ? ? 48 8B 0D ? ? ? ? 48 8B D8 F6 81 ? ? ? ? ? 74 ? 83 B9 ? ? ? ? ? 75 ? E8 ? ? ? ? 45 33 C0 33 D2 48 8B CB E8 ? ? ? ? 84 C0 0F 84 ? ? ? ? 48 85 DB 0F 84 ? ? ? ? 80 7B ? ? 0F 85 ? ? ? ? 48 8B 05 ? ? ? ? 48 8B 88 ? ? ? ? 48 8B 01 48 85 C0 0F 84 ? ? ? ? 48 8B 78 ? 33 D2 48 8B CB E8 ? ? ? ? 48 85 C0 0F 84 ? ? ? ? 45 33 C0 48 8D 4C 24 ? 48 8B D0 E8 ? ? ? ? F2 0F 10 38 8B 58 ? 48 8B 05 ? ? ? ? 48 8B 88 ? ? ? ? 48 8B 09 48 85 C9 0F 84 ? ? ? ? 48 8B 49 ? 48 85 C9 0F 84 ? ? ? ? 33 D2 E8 ? ? ? ? 48 85 C0 74 ? 45 33 C0 0F 29 74 24 ? 48 8B D0 48 8D 4C 24 ? E8 ? ? ? ? 48 8B 0D ? ? ? ? 0F 10 30 F6 81 ? ? ? ? ? 74 ? 83 B9 ? ? ? ? ? 75 ? E8 ? ? ? ? 4C 8B 0D ? ? ? ? 4C 8D 44 24 ? 48 8D 54 24 ? 66 0F 7F 74 24 ? 48 8B CF F2 0F 11 7C 24 ? 89 5C 24 ? E8 ? ? ? ? 0F 28 74 24 ? 0F 28 7C 24 ? 48 8B 5C 24 ? 48 8B 74 24 ? 48 83 C4 ? 5F C3 E8 ? ? ? ? CC CC CC CC CC CC CC CC CC CC CC CC CC 48 89 5C 24"),
			GamemodeHat, StealHat);*/
		DO_HOOK(MEM::PatternScan("GameAssembly.dll", "48 89 5C 24 ? 48 89 74 24 ? 57 48 83 EC ? 80 3D ? ? ? ? ? 49 8B F0 48 8B FA 48 8B D9 75 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? C6 05 ? ? ? ? ? 0F 29 7C 24 ? 48 85 FF 74 ? 48 8B 05 ? ? ? ? 48 8B 88 ? ? ? ? 48 8B 01 48 85 C0 0F 84 ? ? ? ? 48 8B 48 ? 48 85 C9 0F 84 ? ? ? ? 4C 8B 05 ? ? ? ? 48 8B D7 E8 ? ? ? ? 84 C0 74 ? 45 33 C9 4C 8B C7 33 D2 48 8B CB E8 ? ? ? ? 45 33 C9 4C 8B C6 B2"),
			GamemodeTag, TagPlayer);
		DO_HOOK(MEM::PatternScan("GameAssembly.dll", "48 89 5C 24 ? 48 89 74 24 ? 48 89 7C 24 ? 4C 89 74 24 ? 55 48 8B EC 48 83 EC ? 80 3D ? ? ? ? ? 4D 8B F1 49 8B F8 8B F2 48 8B D9 75 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? C6 05 ? ? ? ? ? 0F 10 43 ? 8B 43 ? 48 8D 4D ? 33 D2 89 45 ? 0F 29 45 ? E8 ? ? ? ? 85 C0 0F 8E ? ? ? ? 0F 10 43 ? 8B 43 ? 48 8D 4D ? 33 D2 89 45 ? 0F 29 45 ? E8 ? ? ? ? 2B C6 48 8D 4D ? 8B D0 45 33 C0 E8 ? ? ? ? 33 D2 48 8B CF 0F 10 00 0F 11 43 ? 8B 40 ? 89 43 ? E8 ? ? ? ? 0F 2F 05 ? ? ? ? 0F 86 ? ? ? ? 48 8B 0D ? ? ? ? F6 81 ? ? ? ? ? 74 ? 83 B9 ? ? ? ? ? 75 ? E8 ? ? ? ? 33 C9 E8 ? ? ? ? F2 0F 10 17 4C 8B C8 F3 0F 10 0D ? ? ? ? 0F 28 DA 8B 4F ? 0F 28 C3 0F C6 C0 ? 0F 57 C1 F2 0F 11 55 ? F3 0F 11 45 ? 0F 57 D1 89 4D ? F3 0F 10 45 ? 0F 57 C1 89 4D ? F3 0F 11 45 ? F3 0F 11 55 ? 89 4D ? F2 0F 11 5D ? F2 0F 11 5D ? 48 85 C0 0F 84 ? ? ? ? F2 0F 10 45 ? 48 8D 55 ? 8B 45 ? 45 33 C0 49 8B C9 F2 0F 11 45 ? 89 45 ? E8 ? ? ? ? 0F 10 43 ? 8B 43 ? 48 8D 4D ? 33 D2 89 45 ? 0F 29 45 ? E8 ? ? ? ? 85 C0 7F ? 45 33 C0 48 8D 4D ? 33 D2"),
			PlayerStatus, DamagePlayer);
		DO_HOOK(MEM::PatternScan("GameAssembly.dll", "40 56 48 83 EC ? 80 3D ? ? ? ? ? 48 8B F1 75 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? C6 05 ? ? ? ? ? 48 8B 05 ? ? ? ? 48 89 5C 24 ? 48 89 7C 24 ? 48 8B 88 ? ? ? ? 48 8B 11 48 85 D2 0F 84 ? ? ? ? 48 8B 52 ? 48 8D 4E ? 48 89 56 ? E8 ? ? ? ? 48 8B 05 ? ? ? ? 48 8B 88 ? ? ? ? 48 8B 11 48 85 D2 0F 84 ? ? ? ? 48 8B 52 ? 48 8D 4E ? 48 89 56 ? E8 ? ? ? ? 48 8B 05 ? ? ? ? 48 8B 88 ? ? ? ? 48 8B 09 48 85 C9 0F 84 ? ? ? ? 33 D2 E8 ? ? ? ? 48 8B 56 ? C6 46 ? ? 48 85 D2 0F 84 ? ? ? ? 48 8B 4E ? 48 85 C9 0F 84 ? ? ? ? 4C 8B 05 ? ? ? ? 48 8B 52 ? E8 ? ? ? ? 48 8B 46 ? 48 85 C0 0F 84 ? ? ? ? 8B 78 ? 48 8B 46 ? 48 85 C0 0F 84 ? ? ? ? 48 8B 0D ? ? ? ? 8B 58 ? F6 81 ? ? ? ? ? 74 ? 83 B9 ? ? ? ? ? 75 ? E8 ? ? ? ? 45 33 C0 8B D3 8B CF E8 ? ? ? ? 33 D2 48 8B CE E8 ? ? ? ? 33 D2 48 8B CE E8 ? ? ? ? 48 8B 46 ? 48 85 C0 0F 84 ? ? ? ? 8B 50 ? 45 33 C0 48 8B 4E ? E8 ? ? ? ? 80 3D ? ? ? ? ? 75 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? C6 05 ? ? ? ? ? 4C 8B 05 ? ? ? ? 45 33 C9 48 8B 15 ? ? ? ? 48 8B 4E ? E8 ? ? ? ? 4C 8B 05 ? ? ? ? 45 33 C9 48 8B 15 ? ? ? ? 48 8B 4E ? E8 ? ? ? ? 48 8B 46 ? 48 8B 5E ? 48 85 C0 74 ? 83 78 ? ? 48 8D 4C 24 ? 0F 94 44 24 ? 33 D2 E8 ? ? ? ? 48 8B 15 ? ? ? ? 45 33 C9 4C 8B C0 48 8B CB E8 ? ? ? ? 48 8B 5E ? 33 D2 48 8B CE E8 ? ? ? ? 33 D2 48 8B CE 48 8B F8 E8 ? ? ? ? 45 33 C9 4C 8B C0 48 8B D7 48 8B CB E8 ? ? ? ? 48 8B 7C 24 ? 48 8B 5C 24 ? 48 83 C4 ? 5E C3 E8 ? ? ? ? CC E8 ? ? ? ? CC CC CC CC 48 89 5C 24 ? 57 48 83 EC ? 49 8B C0"),
			LobbyManager, StartLobby);
		DO_HOOK(MEM::PatternScan("GameAssembly.dll", "48 89 5C 24 ? 48 89 54 24 ? 57 48 83 EC ? 48 8B DA 48 8B F9 80 3D ? ? ? ? ? 75 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? C6 05 ? ? ? ? ? 45 33 C0"),
			LobbyManager, BanPlayer);
		DO_HOOK(MEM::PatternScan("GameAssembly.dll", "48 89 5C 24 ? 57 48 83 EC ? 48 8B F9 80 3D ? ? ? ? ? 75 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? C6 05"),
			GameManager, GetPlayersAlive);
		DO_HOOK(MEM::PatternScan("GameAssembly.dll", "48 89 5C 24 ? 48 89 74 24 ? 48 89 7C 24 ? 41 56 48 83 EC ? 4C 8B F2 48 8B F1 80 3D ? ? ? ? ? 75 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? C6 05 ? ? ? ? ? 33 FF 48 8B 0D ? ? ? ? E8 ? ? ? ? 48 8B D8 48 89 44 24 ? 45 33 C0 8D 57 ? 48 8B C8 E8 ? ? ? ? 90 48 85 DB 0F 84 ? ? ? ? F2 0F 10 06 F2 0F 11 44 24 ? 8B 46 ? 89 44 24 ? 45 33 C0 48 8D 54 24 ? 48 8B CB E8 ? ? ? ? 48 8B 0D ? ? ? ? F6 81 ? ? ? ? ? 74 ? 39 B9 ? ? ? ? 75 ? E8 ? ? ? ? 45 33 C0 49 8B D6 48 8B CB E8 ? ? ? ? 90 EB ? 48 8B 5C 24 ? 48 8B 7C 24 ? 48 85 DB 74 ? 33 C9 4C 8B C3 48 8B 15 ? ? ? ? E8 ? ? ? ? 48 85 FF 75 ? EB ? 48 8D 0D ? ? ? ? E8 ? ? ? ? F6 80 ? ? ? ? ? 74 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 83 B8 ? ? ? ? ? 75 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8B C8 E8 ? ? ? ? 33 D2 48 8B 4C 24 ? E8 ? ? ? ? 48 8B 5C 24 ? 48 8B 74 24 ? 48 8B 7C 24 ? 48 83 C4 ? 41 5E C3 E8 ? ? ? ? 90 33 D2 48 8B CF E8 ? ? ? ? CC CC CC CC CC CC CC CC CC CC CC CC CC 48 89 5C 24 ? 57 48 83 EC ? 0F 29 74 24"),
			ClientSend, PlayerPosition);
		DO_HOOK(MEM::PatternScan("GameAssembly.dll", "48 89 5C 24 ? 48 89 74 24 ? 57 48 83 EC ? 0F 29 74 24 ? 0F 29 7C 24 ? 49 8B F0"),
			ClientSend, PlayerRotation);
		DO_HOOK(MEM::PatternScan("GameAssembly.dll", "48 89 5C 24 ? 48 89 74 24 ? 48 89 7C 24 ? 41 56 48 83 EC ? 48 8B F2 44 8B F1 80 3D ? ? ? ? ? 75 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? C6 05 ? ? ? ? ? 33 FF 48 8B 0D ? ? ? ? E8 ? ? ? ? 48 8B D8 48 89 44 24 ? 45 33 C0 8D 57 ? 48 8B C8 E8 ? ? ? ? 90 48 85 DB 0F 84 ? ? ? ? 45 33 C0 41 8B D6 48 8B CB E8 ? ? ? ? F2 0F 10 06 F2 0F 11 44 24 ? 8B 46 ? 89 44 24 ? 45 33 C0 48 8D 54 24 ? 48 8B CB E8 ? ? ? ? 48 8B 0D ? ? ? ? F6 81 ? ? ? ? ? 74 ? 39 B9 ? ? ? ? 75 ? E8 ? ? ? ? 33 D2 48 8B CB E8 ? ? ? ? 90 EB ? 48 8B 5C 24 ? 48 8B 7C 24 ? 48 85 DB 74 ? 33 C9 4C 8B C3 48 8B 15 ? ? ? ? E8 ? ? ? ? 48 85 FF 75 ? EB ? 48 8D 0D ? ? ? ? E8 ? ? ? ? F6 80 ? ? ? ? ? 74 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 83 B8 ? ? ? ? ? 75 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8B C8 E8 ? ? ? ? 33 D2 48 8B 4C 24 ? E8 ? ? ? ? 48 8B 5C 24 ? 48 8B 74 24 ? 48 8B 7C 24 ? 48 83 C4 ? 41 5E C3 E8 ? ? ? ? 90 33 D2 48 8B CF E8 ? ? ? ? CC CC CC 48 89 5C 24 ? 48 89 74 24 ? 57"),
			ClientSend, UseItem);
		DO_HOOK(MEM::PatternScan("GameAssembly.dll", "48 89 5C 24 ? 48 89 7C 24 ? 55 48 8D 6C 24 ? 48 81 EC ? ? ? ? 80 3D ? ? ? ? ? 48 8B FA 48 8B D9 75 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? C6 05 ? ? ? ? ? 48 8B 43 ? 48 89 B4 24 ? ? ? ? 4C 89 B4 24 ? ? ? ? 0F 29 B4 24 ? ? ? ? 0F 29 BC 24 ? ? ? ? 44 0F 29 84 24 ? ? ? ? 48 85 C0 0F 84 ? ? ? ? 48 8B 88 ? ? ? ? 48 85 C9 0F 84 ? ? ? ? 80 79 ? ? 75 ? 80 7B ? ? 0F 85 ? ? ? ? 48 8B 15 ? ? ? ? 45 33 C0 48 8B CB E8 ? ? ? ? 84 C0 0F 85 ? ? ? ? C6 43 ? ? 38 43 ? 0F 84 ? ? ? ? 88 43 ? 48 8B 43 ? 48 85 C0 0F 84 ? ? ? ? 48 8B 88 ? ? ? ? 48 85 C9 0F 84 ? ? ? ? F3 0F 10 41 ? 45 33 C9 F3 0F 5E 05 ? ? ? ? 48 8B CB 48 8B 15 ? ? ? ? F3 0F 10 35"),
			ItemGun, TryUse);
		DO_HOOK(MEM::PatternScan("GameAssembly.dll", "48 89 5C 24 ? 57 48 83 EC ? 80 3D ? ? ? ? ? 48 8B FA 48 8B D9 75 ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? 48 8D 0D ? ? ? ? E8 ? ? ? ? C6 05 ? ? ? ? ? 80 7B ? ? 0F 84 ? ? ? ? 0F 29 74 24"),
			ItemMelee, TryUse);
	}

	if (MH_EnableHook(MH_ALL_HOOKS) != MH_OK)
		return false;

	return true;
}

INL bool Hook::Shutdown()
{
	return MH_Uninitialize();
}